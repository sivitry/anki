<!DOCTYPE html>
<html>
<head>
</head>
<body "height:100%;    width:100%;    padding:0;    margin:0;">
	
	
	<div id = "practiceName">
		Smart Practice
	</div>

	
	<h2>
	<div id='problem'>	</div>
	
	<table width="100%">
		<tr> 
		<td> <button id='btn1' type="button" onclick=""> A </button> </td>
		<td id='ans1' width="90%"> </td>
		</tr>
		<tr> 
		<td> <button id='btn2' type="button" onclick=""> B </button> </td>
		<td id='ans2'> </td>
		</tr>
		<tr> 
		<td> <button id='btn3' type="button" onclick=""> C </button> </td>
		<td id='ans3'> </td>
		</tr>
		<tr> 
		<td> <button id='btn4' type="button" onclick=""> D </button> </td>
		<td id='ans4'> </td>
		</tr>
	</table>
	</h2>
	
    <div>
		<textarea id="userAnswer" readonly rows="4" cols="30" style="border-radius:5px; resize:none;">
		</textarea>
	</div>	
	
	<button onclick="location.replace(location);"> New Problem </button>
		
	
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
	
	<script>
		// config Google Sheet's public access [key] and target [worksheetId] (not Work Sheet Name)
		var appConfig = {
			key:'1_pMUa6H8p-7anpqaSzYnsAL3Tt6clhV3wdG9XCi3M8o',		
			worksheetId:'2'		
		};		
	
		var numberOne = 2; 
		var numberTwo = 2; 
		var numberThree = 2; 
		var numberFour = 2; 		
		var totalProblem = 1;
		var answernum = 3;
		var numberCorrect;
		var answerEng='A';
		
		init();		
		
		function answermsg(value, correct){
			//console.log(value);				
			el = document.getElementById('userAnswer');	
			if(value === correct){				
				el.innerHTML="You choose: "+value+"\n"+"Great!! This is right answer.";
			}
			else{				
				el.innerHTML="You choose: "+value+"\n"+"The Answer is: "+correct;
			}
		}	
		
		// get and set total list number
		function init(){
		
			// Practice Title initialization
			// Get Work Sheet Name from worksheetId. 			
			requesturl = "https://spreadsheets.google.com/feeds/worksheets/"+appConfig.key+"/public/full?alt=json";
			$.getJSON(requesturl, function(data){			
				console.log(data);				
				wsn = data.feed.entry[appConfig.worksheetId-1].title.$t;
				console.log("Work Sheet Name = "+wsn);
				el = document.getElementById("practiceName");
				//str = "<h2>"+wsn+" Practice"+"</h2>";
				str = wsn+" Practice";
				el.innerHTML=str;
			});
			
		
			requesturl = "https://spreadsheets.google.com/feeds/list/"+appConfig.key+"/"+appConfig.worksheetId+"/public/full?alt=json";
			$.getJSON(requesturl, function(data){
			//$.getJSON('https://spreadsheets.google.com/feeds/list/1_pMUa6H8p-7anpqaSzYnsAL3Tt6clhV3wdG9XCi3M8o/1/public/full?alt=json', function(data){
				console.log(data);				
				totalProblem = data.feed.entry.length;
				console.log("sizeof totalProblem = "+totalProblem);
				
				// get number1~4, run loop until number is different than previous
				numberOne = Math.floor(Math.random() * totalProblem)+1;								
				do {
					numberTwo = Math.floor(Math.random() * totalProblem)+1;
				} while(numberTwo === numberOne);
				do {
					numberThree = Math.floor(Math.random() * totalProblem)+1;
				} while(numberThree === numberTwo || numberThree === numberOne);
				do {
					numberFour = Math.floor(Math.random() * totalProblem)+1;					
				} while(numberFour === numberThree || numberFour === numberTwo || numberFour === numberOne);
				console.log("numberOne="+numberOne);		
				console.log("numberTwo="+numberTwo);
				console.log("numberThree="+numberThree);
				console.log("numberFour="+numberFour);
				
				// get random correct number(A/B/C/D)
				answernum = Math.floor(Math.random() * totalProblem)%4+1;
				
				if(answernum===1){	numberCorrect = numberOne;	};
				if(answernum===2){	numberCorrect = numberTwo;	};
				if(answernum===3){	numberCorrect = numberThree;	};
				if(answernum===4){	numberCorrect = numberFour;	};				
				console.log("answernum="+answernum);
			}).then(correctNumber);
		};
		
		// get data of random correct number 
		function correctNumber(){			
			requesturl = "https://spreadsheets.google.com/feeds/list/"+appConfig.key+"/"+appConfig.worksheetId+"/public/full?sq=number=="+numberCorrect+"&alt=json";
			$.getJSON(requesturl, function(data){
					console.log(data);
					//console.log(data.feed.entry.length);
					
					// assign problem
					qid = 'problem';
					el = document.getElementById(qid);
					str = data.feed.entry[0].gsx$brief.$t;
					str = "What is "+str+" ?";
					el.innerHTML = str;					
			
					//assign button string					
					if(answernum===1){	answerEng='A';	qid="btn"+answernum; };
					if(answernum===2){	answerEng='B';	qid="btn"+answernum; };
					if(answernum===3){	answerEng='C';	qid="btn"+answernum; };
					if(answernum===4){	answerEng='D';	qid="btn"+answernum; };
					
					el = document.getElementById('btn1');
					el.setAttribute("onclick", "answermsg('A',answerEng);");
					el = document.getElementById('btn2');
					el.setAttribute("onclick", "answermsg('B',answerEng);");
					el = document.getElementById('btn3');
					el.setAttribute("onclick", "answermsg('C',answerEng);");
					el = document.getElementById('btn4');
					el.setAttribute("onclick", "answermsg('D',answerEng);");
					
					//el.setAttribute("onclick", "alert('you choose A, but the correct is: "+answer+"')");					
					//el.setAttribute("onclick", "alert('you choose B, but the correct is: "+answer+"')");					
					//el.setAttribute("onclick", "alert('you choose C, but the correct is: "+answer+"')");					
					//el.setAttribute("onclick", "alert('you choose D, but the correct is: "+answer+"')");
					
					//qid = 'problem';
					//el = document.getElementById(qid);
					//el.setAttribute("onclick", "alert('Great! "+answerEng+" is right answer')");
				}).then(one);
			};					
		
		
		//assign other answer 1
		function one(){
			requesturl = "https://spreadsheets.google.com/feeds/list/"+appConfig.key+"/"+appConfig.worksheetId+"/public/full?sq=number=="+(numberOne)+"&alt=json";
			$.getJSON(requesturl, function(data1){
					//assign correct answer							
					el = document.getElementById('ans1');
					str = data1.feed.entry[0].gsx$original.$t;							
					el.innerHTML = str;					
			}).then(two);				
		};
		
		//assign other answer 2
		function two(){
			requesturl = "https://spreadsheets.google.com/feeds/list/"+appConfig.key+"/"+appConfig.worksheetId+"/public/full?sq=number=="+(numberTwo)+"&alt=json";
			$.getJSON(requesturl, function(data){
					//assign correct answer							
					el = document.getElementById('ans2');
					str = data.feed.entry[0].gsx$original.$t;							
					el.innerHTML = str;					
			}).then(three);
		};
		
		//assign other answer 3
		function three(){
			requesturl = "https://spreadsheets.google.com/feeds/list/"+appConfig.key+"/"+appConfig.worksheetId+"/public/full?sq=number=="+(numberThree)+"&alt=json";
			$.getJSON(requesturl, function(data){
					//assign correct answer							
					el = document.getElementById('ans3');
					str = data.feed.entry[0].gsx$original.$t;							
					el.innerHTML = str;					
			}).then(four);				
		};
		
		//assign other answer 4
		function four(){
			requesturl = "https://spreadsheets.google.com/feeds/list/"+appConfig.key+"/"+appConfig.worksheetId+"/public/full?sq=number=="+(numberFour)+"&alt=json";
			$.getJSON(requesturl, function(data){
					//assign correct answer							
					el = document.getElementById('ans4');
					str = data.feed.entry[0].gsx$original.$t;							
					el.innerHTML = str;					
			}).then(check);				
		};				
		
		function check(){
					
		};
		
		

		
	</script>
</body>
</html> 